<!doctype html><html><head><meta charset="utf-8"><title>Диспетчер</title><link rel="stylesheet" href="/static/style.css"></head><body>
<div class="topbar"><h1>Сводки</h1><div><a href="/export_excel">Сформировать Excel</a> <a href="/logout">Выход</a></div></div>
<div class="content"><div class="panel"><h3>Фильтр</h3><label>По участку: <select id="filterLocation"><option value="">Все</option><option>Карамурын</option><option>Ирколь</option><option>Хорасан</option><option>Заречное</option><option>Степногорск</option></select></label><label>По № агрегата: <input id="filterRig"></label><button id="apply">Применить</button></div>
<div class="panel"><h3>Сводки</h3><table id="reportsTable"><thead><tr><th>ID</th><th>Дата и время</th><th>Участок</th><th>№ агрегата</th><th>Метраж</th><th>Погонометр</th><th>Операция</th><th>Ответственное</th><th>Примечание</th></tr></thead><tbody>{% for r in reports %}<tr><td>{{ r.id }}</td><td>{{ r.date_time }}</td><td>{{ r.location }}</td><td>{{ r.rig_number }}</td><td>{{ r.meterage }}</td><td>{{ r.pogon }}</td><td>{{ r.operation }}</td><td>{{ r.operator_name }}</td><td>{{ r.note }}</td></tr>{% endfor %}</tbody></table></div>
<div class="panel"><h3>Пользователи</h3><form action="/users/create" method="post"><label>Логин: <input name="username" required></label><label>Пароль: <input name="password" required></label><label>Роль: <select name="role"><option value="driller">driller</option><option value="dispatcher">dispatcher</option><option value="admin">admin</option></select></label><label>ФИО: <input name="full_name"></label><label>Участок: <input name="location"></label><label>№ агрегата: <input name="rig_number"></label><button type="submit">Создать</button></form><h4>Список</h4><ul>{% for u in users %}<li>{{ u.id }} - {{ u.username }} - {{ u.role }} - {{ u.full_name }} - {{ u.location }}</li>{% endfor %}</ul></div></div>
<script>document.getElementById('apply').addEventListener('click', ()=>{const loc=document.getElementById('filterLocation').value.toLowerCase();const rig=document.getElementById('filterRig').value.toLowerCase();const rows=document.querySelectorAll('#reportsTable tbody tr');rows.forEach(r=>{const cells=r.querySelectorAll('td');const location=(cells[2].innerText||'').toLowerCase();const rign=(cells[3].innerText||'').toLowerCase();r.style.display = ((loc==''||location.includes(loc)) && (rig==''||rign.includes(rig))) ? '' : 'none';});});</script></body></html>
